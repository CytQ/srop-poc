b main
c
run
c
run 7171
c
set follow-fork-mode child 
c
run 7171
run 7171
b main
run 7171
n
n
run 7171
b main
run 7171
n
n
set follow-fork-mode parent
c
set follow-fork-mode child 
disas main
b read_input
c
c
print buffer
print &buffer
n
n
n
n
n
n
n
n
n
n
set follow-fork-mode child 
c
b read_data
disas main
b read_input
c
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
print &buffer
disas main
b read_input
c
disas read_input
b *0x0000000000400b49
c
n
n
n
n
n
b read_data
disas main
b read_input
c
disas read_input
b 0x0000000000400b57
b *0x0000000000400b57
c
c
c
x/8xw $rip
x/xw $rsp
x/gx $rsp
sttepi
stepi
stepi
stepi
stepi
stepi
stepi
disas main
b read_input
c
disas read_input
c
b read_input
c
disas read_input
b *0x0000000000400b72
c
x/gw $rsp
x/gx $rsp
c
ropsearch
ropsearch "syscall"
ropsearch "
ropsearch "xor rax, rax; ret"
ropsearch "xor rax, rax; ret"
ropsearch "mov rax, 0; ret"
disas mian
disas main
b read_input
c
disas read_input
b *0x00000000004013b2
c
x/4gx $rsp
stepi
b read_input
c
disas read_input 
b *0x00000000004013b2
c
steou
stepi
run 7171
disas ret_15
b read_input
c
disas read_input
b *0x0000000000400b04
c
stepi
b read_input
c
disas read_input
b *0x0000000000400b04
c
stepi
b read_input
disas read_input
b *0x0000000000401384
c
stepi
disas ret_15
c
stepi
c
stepi
disas read_inpu
disas read_input
c
x/gx $rsp
c
c
c
x/gx $rsp
c
x/gx $rs
x/gx $rsp
c
c
stepi
c
c
stepi
c
stepi
b handler
run
handle SIGSHLD
handle SIGHLD
handle SIGCHLD
b handler
run
pass SIGCHLD
noignore SIGCHLD
py
python
exit
ptype $_siginfo
noignore SIGCHLD
info signals
run
delete
run
b handler
r
disas handler
hw break handler
hbreak handler
b main
run
hbreak handler
c
run
delete
run
b handler
run
delete
b handler
run
run
b handler
run
run
b sigreturn
b main
run
b sigreturn
c
